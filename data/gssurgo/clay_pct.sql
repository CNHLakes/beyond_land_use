SELECT mukey, clay_percent_mu FROM (SELECT TBL_LEFT.comppct_r AS comppct_r, TBL_LEFT.cokey AS cokey, TBL_LEFT.mukey AS mukey, TBL_LEFT.clay_percent_co AS clay_percent_co, TBL_LEFT.clay_percent_mu_sum AS clay_percent_mu_sum, TBL_RIGHT.clay_percent_mu AS clay_percent_mu   FROM (SELECT comppct_r, cokey, mukey, clay_percent_co, (comppct_r / 100.0) * clay_percent_co AS clay_percent_mu_sum FROM (SELECT TBL_LEFT.comppct_r AS comppct_r, TBL_LEFT.cokey AS cokey, TBL_LEFT.mukey AS mukey, TBL_RIGHT.clay_percent_co AS clay_percent_co   FROM (SELECT comppct_r, cokey, mukey FROM component) AS TBL_LEFT   LEFT JOIN (SELECT cokey, clay_percent_co FROM (SELECT TBL_LEFT.claytotal_r AS claytotal_r, TBL_LEFT.dbthirdbar_r AS dbthirdbar_r, TBL_LEFT.hzname AS hzname, TBL_LEFT.hzthk_r AS hzthk_r, TBL_LEFT.cokey AS cokey, TBL_LEFT.thk_sum AS thk_sum, TBL_LEFT.thk_frac AS thk_frac, TBL_LEFT.clay_percent AS clay_percent, TBL_LEFT.clay_percent_weighted AS clay_percent_weighted, TBL_RIGHT.clay_percent_co AS clay_percent_co   FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey, thk_sum, thk_frac, clay_percent, clay_percent * thk_frac AS clay_percent_weighted FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey, thk_sum, hzthk_r / thk_sum AS thk_frac, claytotal_r / dbthirdbar_r AS clay_percent FROM (SELECT TBL_LEFT.claytotal_r AS claytotal_r, TBL_LEFT.dbthirdbar_r AS dbthirdbar_r, TBL_LEFT.hzname AS hzname, TBL_LEFT.hzthk_r AS hzthk_r, TBL_LEFT.cokey AS cokey, TBL_RIGHT.thk_sum AS thk_sum   FROM (SELECT claytotal_r, dbthirdbar_r, hzname, COALESCE(hzthk_r, 1.0) AS hzthk_r, cokey FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey FROM chorizon)) AS TBL_LEFT   LEFT JOIN (SELECT cokey, SUM(hzthk_r) + 0.0 AS thk_sum FROM (SELECT claytotal_r, dbthirdbar_r, hzname, COALESCE(hzthk_r, 1.0) AS hzthk_r, cokey FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey FROM chorizon)) GROUP BY cokey) AS TBL_RIGHT   ON (TBL_LEFT.cokey = TBL_RIGHT.cokey) ))) AS TBL_LEFT   INNER JOIN (SELECT cokey, SUM(clay_percent_weighted) AS clay_percent_co FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey, thk_sum, thk_frac, clay_percent, clay_percent * thk_frac AS clay_percent_weighted FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey, thk_sum, hzthk_r / thk_sum AS thk_frac, claytotal_r / dbthirdbar_r AS clay_percent FROM (SELECT TBL_LEFT.claytotal_r AS claytotal_r, TBL_LEFT.dbthirdbar_r AS dbthirdbar_r, TBL_LEFT.hzname AS hzname, TBL_LEFT.hzthk_r AS hzthk_r, TBL_LEFT.cokey AS cokey, TBL_RIGHT.thk_sum AS thk_sum   FROM (SELECT claytotal_r, dbthirdbar_r, hzname, COALESCE(hzthk_r, 1.0) AS hzthk_r, cokey FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey FROM chorizon)) AS TBL_LEFT   LEFT JOIN (SELECT cokey, SUM(hzthk_r) + 0.0 AS thk_sum FROM (SELECT claytotal_r, dbthirdbar_r, hzname, COALESCE(hzthk_r, 1.0) AS hzthk_r, cokey FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey FROM chorizon)) GROUP BY cokey) AS TBL_RIGHT   ON (TBL_LEFT.cokey = TBL_RIGHT.cokey) ))) GROUP BY cokey) AS TBL_RIGHT   ON (TBL_LEFT.cokey = TBL_RIGHT.cokey) ) GROUP BY cokey, clay_percent_co) AS TBL_RIGHT   ON (TBL_LEFT.cokey = TBL_RIGHT.cokey) )) AS TBL_LEFT   INNER JOIN (SELECT mukey, SUM(clay_percent_mu_sum) AS clay_percent_mu FROM (SELECT comppct_r, cokey, mukey, clay_percent_co, (comppct_r / 100.0) * clay_percent_co AS clay_percent_mu_sum FROM (SELECT TBL_LEFT.comppct_r AS comppct_r, TBL_LEFT.cokey AS cokey, TBL_LEFT.mukey AS mukey, TBL_RIGHT.clay_percent_co AS clay_percent_co   FROM (SELECT comppct_r, cokey, mukey FROM component) AS TBL_LEFT   LEFT JOIN (SELECT cokey, clay_percent_co FROM (SELECT TBL_LEFT.claytotal_r AS claytotal_r, TBL_LEFT.dbthirdbar_r AS dbthirdbar_r, TBL_LEFT.hzname AS hzname, TBL_LEFT.hzthk_r AS hzthk_r, TBL_LEFT.cokey AS cokey, TBL_LEFT.thk_sum AS thk_sum, TBL_LEFT.thk_frac AS thk_frac, TBL_LEFT.clay_percent AS clay_percent, TBL_LEFT.clay_percent_weighted AS clay_percent_weighted, TBL_RIGHT.clay_percent_co AS clay_percent_co   FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey, thk_sum, thk_frac, clay_percent, clay_percent * thk_frac AS clay_percent_weighted FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey, thk_sum, hzthk_r / thk_sum AS thk_frac, claytotal_r / dbthirdbar_r AS clay_percent FROM (SELECT TBL_LEFT.claytotal_r AS claytotal_r, TBL_LEFT.dbthirdbar_r AS dbthirdbar_r, TBL_LEFT.hzname AS hzname, TBL_LEFT.hzthk_r AS hzthk_r, TBL_LEFT.cokey AS cokey, TBL_RIGHT.thk_sum AS thk_sum   FROM (SELECT claytotal_r, dbthirdbar_r, hzname, COALESCE(hzthk_r, 1.0) AS hzthk_r, cokey FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey FROM chorizon)) AS TBL_LEFT   LEFT JOIN (SELECT cokey, SUM(hzthk_r) + 0.0 AS thk_sum FROM (SELECT claytotal_r, dbthirdbar_r, hzname, COALESCE(hzthk_r, 1.0) AS hzthk_r, cokey FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey FROM chorizon)) GROUP BY cokey) AS TBL_RIGHT   ON (TBL_LEFT.cokey = TBL_RIGHT.cokey) ))) AS TBL_LEFT   INNER JOIN (SELECT cokey, SUM(clay_percent_weighted) AS clay_percent_co FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey, thk_sum, thk_frac, clay_percent, clay_percent * thk_frac AS clay_percent_weighted FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey, thk_sum, hzthk_r / thk_sum AS thk_frac, claytotal_r / dbthirdbar_r AS clay_percent FROM (SELECT TBL_LEFT.claytotal_r AS claytotal_r, TBL_LEFT.dbthirdbar_r AS dbthirdbar_r, TBL_LEFT.hzname AS hzname, TBL_LEFT.hzthk_r AS hzthk_r, TBL_LEFT.cokey AS cokey, TBL_RIGHT.thk_sum AS thk_sum   FROM (SELECT claytotal_r, dbthirdbar_r, hzname, COALESCE(hzthk_r, 1.0) AS hzthk_r, cokey FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey FROM chorizon)) AS TBL_LEFT   LEFT JOIN (SELECT cokey, SUM(hzthk_r) + 0.0 AS thk_sum FROM (SELECT claytotal_r, dbthirdbar_r, hzname, COALESCE(hzthk_r, 1.0) AS hzthk_r, cokey FROM (SELECT claytotal_r, dbthirdbar_r, hzname, hzthk_r, cokey FROM chorizon)) GROUP BY cokey) AS TBL_RIGHT   ON (TBL_LEFT.cokey = TBL_RIGHT.cokey) ))) GROUP BY cokey) AS TBL_RIGHT   ON (TBL_LEFT.cokey = TBL_RIGHT.cokey) ) GROUP BY cokey, clay_percent_co) AS TBL_RIGHT   ON (TBL_LEFT.cokey = TBL_RIGHT.cokey) )) GROUP BY mukey) AS TBL_RIGHT   ON (TBL_LEFT.mukey = TBL_RIGHT.mukey) ) GROUP BY mukey, clay_percent_mu
